<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¹Ø¯ Ø§Ù„Ø¯ÙˆØ±Ø© | Ø§Ù„Ø¯ÙŠÙˆØ§Ù† Ø§Ù„Ø¬Ø§Ù…Ø¹ÙŠ</title>
    <style>
        body {
            background-color: #0d1117; /* Ù„ÙˆÙ† Ø®Ù„ÙÙŠØ© ØºØ§Ù…Ù‚ */
            color: #c9d1d9;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            text-align: center;
        }
        .card {
            background-color: #161b22;
            border: 1px solid #30363d;
            border-radius: 15px;
            padding: 2rem;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.5);
        }
        h1 { color: #58a6ff; margin-bottom: 0.5rem; }
        p { margin-bottom: 2rem; font-size: 1.1rem; }
        .btn {
            display: block;
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            cursor: pointer;
            text-decoration: none;
            font-weight: bold;
            transition: transform 0.2s;
        }
        .btn:hover { transform: scale(1.02); }
        .google { background-color: #ea4335; color: white; }
        .apple { background-color: #ffffff; color: black; }
        .outlook { background-color: #0078d4; color: white; }
    </style>
</head>
<body>

    <div class="card">
        <h1 id="eventTitle">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¯ÙˆØ±Ø©</h1>
        <p id="eventTime">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙˆÙ‚ÙŠØª...</p>

        <a id="googleBtn" class="btn google" target="_blank">ğŸ“… ØªÙ‚ÙˆÙŠÙ… Google</a>
        <a id="appleBtn" class="btn apple">ğŸ ØªÙ‚ÙˆÙŠÙ… Apple (iOS)</a>
        <a id="outlookBtn" class="btn outlook" target="_blank">ğŸ“§ ØªÙ‚ÙˆÙŠÙ… Outlook</a>
    </div>

    <script>
        // Ø¯Ø§Ù„Ø© Ù„Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø·
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        // Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø·
        const title = getQueryParam('title') || 'Ù„Ù‚Ø§Ø¡ Ø§Ù„Ø¯ÙŠÙˆØ§Ù† Ø§Ù„Ø¬Ø§Ù…Ø¹ÙŠ';
        const start = getQueryParam('start'); // Ø§Ù„ØµÙŠØºØ©: YYYYMMDDTHHMMSS
        const end = getQueryParam('end');     // Ø§Ù„ØµÙŠØºØ©: YYYYMMDDTHHMMSS
        const details = getQueryParam('desc') || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªÙØ§ØµÙŠÙ„ Ø¥Ø¶Ø§ÙÙŠØ©';
        
        // Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø§Ù„ØµÙØ­Ø©
        document.getElementById('eventTitle').innerText = title;
        if(start) {
            // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ÙˆÙ‚Øª Ù„Ù„Ø¹Ø±Ø¶ Ø¨Ø´ÙƒÙ„ Ø¬Ù…ÙŠÙ„
            const year = start.substring(0,4);
            const month = start.substring(4,6);
            const day = start.substring(6,8);
            const hour = start.substring(9,11);
            const min = start.substring(11,13);
            document.getElementById('eventTime').innerText = `${day}/${month}/${year} - Ø§Ù„Ø³Ø§Ø¹Ø© ${hour}:${min}`;
        }

        // 1. Ø±Ø§Ø¨Ø· Ø¬ÙˆØ¬Ù„
        const googleUrl = `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(title)}&dates=${start}/${end}&details=${encodeURIComponent(details)}`;
        document.getElementById('googleBtn').href = googleUrl;

        // 2. Ø±Ø§Ø¨Ø· Ø£ÙˆØªÙ„ÙˆÙƒ
        const outlookUrl = `https://outlook.live.com/calendar/0/deeplink/compose?subject=${encodeURIComponent(title)}&startdt=${start}&enddt=${end}&body=${encodeURIComponent(details)}`;
        document.getElementById('outlookBtn').href = outlookUrl;

        // 3. Ù…Ù„Ù ICS Ù„Ù„Ø¢ÙŠÙÙˆÙ† (Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ)
        document.getElementById('appleBtn').onclick = function() {
            const icsContent = `BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//Aldiwan Aljamei//NONSGML Event//EN
BEGIN:VEVENT
UID:${Date.now()}@aldiwan.dev
DTSTAMP:${start}Z
DTSTART:${start}Z
DTEND:${end}Z
SUMMARY:${title}
DESCRIPTION:${details}
END:VEVENT
END:VCALENDAR`;

            const blob = new Blob([icsContent], { type: 'text/calendar;charset=utf-8' });
            const link = document.createElement('a');
            link.href = window.URL.createObjectURL(blob);
            link.setAttribute('download', 'event.ics');
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        };
    </script>

</body>
</html>
